{"remainingRequest":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\src\\views\\admin\\channel\\Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\src\\views\\admin\\channel\\Edit.vue","mtime":1645432583008},{"path":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645012147060},{"path":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\node_modules\\babel-loader\\lib\\index.js","mtime":1645012162188},{"path":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1645012147060},{"path":"F:\\Program Files (x86)\\vue博客系统\\block_cms_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1645012163094}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyB1cGRhdGUsIHRyZWUsIHVwbG9hZCwgZGV0YWlsIH0gZnJvbSAiLi4vLi4vLi4vYXBpL2NoYW5uZWwiOw0KLy8gaW1wb3J0IHRoZSBjb21wb25lbnQNCmltcG9ydCBUcmVlc2VsZWN0IGZyb20gIkByaW9waGFlL3Z1ZS10cmVlc2VsZWN0IjsNCi8vIGltcG9ydCB0aGUgc3R5bGVzDQppbXBvcnQgIkByaW9waGFlL3Z1ZS10cmVlc2VsZWN0L2Rpc3QvdnVlLXRyZWVzZWxlY3QuY3NzIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiRWRpdCIsDQogIGNvbXBvbmVudHM6IHsgVHJlZXNlbGVjdCB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBkZWZGb3JtOiB7DQogICAgICAgIGlkOiIiLA0KICAgICAgICBuYW1lOiAiIiwNCiAgICAgICAgcGFyZW50SWQ6IG51bGwsDQogICAgICAgIGNoYW5uZWxJbWc6ICIiLA0KICAgICAgICBzdW1tYXJ5OiAiIiwNCiAgICAgICAgc2luZ2xlOiBmYWxzZSwNCiAgICAgICAgdXJsOiAiIiwNCiAgICAgICAgc2VvVGl0bGU6ICIiLA0KICAgICAgICBzZW9LZXl3b3JkOiAiIiwNCiAgICAgICAgc2VvRGVzY3JpcHRpb246ICIiLA0KICAgICAgICBjb250ZW50OiAiIiwNCiAgICAgIH0sDQogICAgICBydWxlczogew0KICAgICAgICB1c2VyTmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLlv4XloavpobnkuI3og73kuLrnqboiIH1dLA0KICAgICAgICBwYXNzd29yZDogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLlv4XloavpobnkuI3og73kuLrnqboiIH1dLA0KICAgICAgfSwNCiAgICAgIHRyZWVEYXRhOiBbXSwNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgbGV0IGlkID0gdGhpcy4kcm91dGUucXVlcnkuaWQ7DQogICAgZGV0YWlsKGlkKQ0KICAgICAgLnRoZW4oKGRhdGEpID0+IHsNCiAgICAgICAgdGhpcy5kZWZGb3JtID0gZGF0YS5kYXRhOw0KICAgICAgICBpZiAoIWRhdGEuZGF0YS5jb250ZW50KSB7DQogICAgICAgICAgdGhpcy5kZWZGb3JtLmNvbnRlbnQgPSAiIjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZGF0YS5kYXRhLnBhcmVudElkID09IDApIHsNCiAgICAgICAgICB0aGlzLmRlZkZvcm0ucGFyZW50SWQgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIGlmIChkYXRhLmRhdGEuc2luZ2xlID09ICJZIikgew0KICAgICAgICAgIHRoaXMuZGVmRm9ybS5zaW5nbGUgPSB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuZGVmRm9ybS5zaW5nbGUgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnJvcik7DQogICAgICB9KTsNCg0KICAgIHRyZWUoKQ0KICAgICAgLnRoZW4oKGRhdGEpID0+IHsNCiAgICAgICAgdGhpcy50cmVlRGF0YSA9IGRhdGEuZGF0YTsNCiAgICAgICAgY29uc29sZS5sb2codGhpcy50cmVlRGF0YSk7DQogICAgICB9KQ0KICAgICAgLmNhdGNoKCgpID0+IHt9KTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHN1Ym1pdEZvcm0oKSB7DQogICAgICB0aGlzLiRyZWZzWyJkZWZGb3JtIl0udmFsaWRhdGUoKHZhbGlkKSA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZGVmRm9ybSk7DQogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgICAgICBpZiAodGhpcy5kZWZGb3JtLnNpbmdsZSkgew0KICAgICAgICAgICAgdGhpcy5kZWZGb3JtLnNpbmdsZSA9ICJZIjsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5kZWZGb3JtLnNpbmdsZSA9ICJOIjsNCiAgICAgICAgICB9DQogICAgICAgICAgdXBkYXRlKHRoaXMuZGVmRm9ybSkNCiAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICB0aGlzLiRyZWZzWyJkZWZGb3JtIl0ucmVzZXRGaWVsZHMoKTsNCiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGRhdGEubXNnKTsNCiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9jaGFubmVsIik7DQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gew0KICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnJvcik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBjbG9zZSgpIHsNCiAgICAgIHRoaXMuJGVtaXQoImhpZGVEaWFsb2ciKTsNCiAgICB9LA0KICAgIHVwbG9hZEltZyhwYXJhbSkgew0KICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZmlsZSIsIHBhcmFtLmZpbGUpOw0KICAgICAgdXBsb2FkKGZvcm1EYXRhKQ0KICAgICAgICAudGhlbigoZGF0YSkgPT4gew0KICAgICAgICAgIHRoaXMuZGVmRm9ybS5jaGFubmVsSW1nID0gZGF0YS5kYXRhOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnJvcik7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy/kuIrkvKDkuYvliY3nmoTpqozor4ENCiAgICBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgew0KICAgICAgY29uc3QgaXNJTUFHRSA9DQogICAgICAgIGZpbGUudHlwZSA9PT0gImltYWdlL2pwZWciIHx8DQogICAgICAgIGZpbGUudHlwZSA9PT0gImltYWdlL2pwZyIgfHwNCiAgICAgICAgZmlsZS50eXBlID09PSAiaW1hZ2UvcG5nIjsNCiAgICAgIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsNCiAgICAgIGlmICghaXNJTUFHRSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDmlofku7blj6rog73mmK/lm77niYfmoLzlvI8hIik7DQogICAgICB9DQogICAgICBpZiAoIWlzTHQyTSkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDmlofku7blpKflsI/kuI3og73otoXov4cgMk1CISIpOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGlzSU1BR0UgJiYgaXNMdDJNOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["Edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Edit.vue","sourceRoot":"src/views/admin/channel","sourcesContent":["<template>\r\n  <div>\r\n    <el-form ref=\"defForm\" :rules=\"rules\" :model=\"defForm\" label-width=\"120px\">\r\n      <el-form-item label=\"栏目名\" prop=\"name\">\r\n        <el-input v-model=\"defForm.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"父栏目\" prop=\"parentId\">\r\n        <Treeselect\r\n          v-model=\"defForm.parentId\"\r\n          :multiple=\"false\"\r\n          :options=\"treeData\"\r\n          placeholder=\"请选择父栏目\"\r\n        ></Treeselect>\r\n      </el-form-item>\r\n      <el-form-item label=\"栏目图片\" prop=\"channelImg\">\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          action=\"string\"\r\n          :show-file-list=\"false\"\r\n          :http-request=\"uploadImg\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n        >\r\n          <img\r\n            v-if=\"defForm.channelImg\"\r\n            :src=\"defForm.channelImg\"\r\n            class=\"avatar\"\r\n          />\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"摘要\" prop=\"summary\">\r\n        <el-input v-model=\"defForm.summary\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"是否单页\" prop=\"single\">\r\n        <el-switch\r\n          v-model=\"defForm.single\"\r\n          active-color=\"#13ce66\"\r\n          inactive-color=\"#999999\"\r\n        >\r\n        </el-switch>\r\n      </el-form-item>\r\n      <el-form-item label=\"外链\" prop=\"url\">\r\n        <el-input v-model=\"defForm.url\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"seo title\" prop=\"seoTitle\">\r\n        <el-input v-model=\"defForm.seoTitle\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"seo keyword\" prop=\"seoKeyword\">\r\n        <el-input v-model=\"defForm.seoKeyword\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"seo description\" prop=\"seoDescription\">\r\n        <el-input v-model=\"defForm.seoDescription\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"content\" prop=\"content\">\r\n        <v-md-editor v-model=\"defForm.content\" height=\"400px\"></v-md-editor>\r\n      </el-form-item>\r\n\r\n      <el-form-item size=\"large\">\r\n        <el-button type=\"primary\" @click=\"$router.back()\">返回</el-button>\r\n        <el-button type=\"primary\" :loading=\"loading\" @click=\"submitForm\"\r\n          >保存</el-button\r\n        >\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { update, tree, upload, detail } from \"../../../api/channel\";\r\n// import the component\r\nimport Treeselect from \"@riophae/vue-treeselect\";\r\n// import the styles\r\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\r\n\r\nexport default {\r\n  name: \"Edit\",\r\n  components: { Treeselect },\r\n  data() {\r\n    return {\r\n      defForm: {\r\n        id:\"\",\r\n        name: \"\",\r\n        parentId: null,\r\n        channelImg: \"\",\r\n        summary: \"\",\r\n        single: false,\r\n        url: \"\",\r\n        seoTitle: \"\",\r\n        seoKeyword: \"\",\r\n        seoDescription: \"\",\r\n        content: \"\",\r\n      },\r\n      rules: {\r\n        userName: [{ required: true, message: \"必填项不能为空\" }],\r\n        password: [{ required: true, message: \"必填项不能为空\" }],\r\n      },\r\n      treeData: [],\r\n      loading: false,\r\n    };\r\n  },\r\n  created() {\r\n    let id = this.$route.query.id;\r\n    detail(id)\r\n      .then((data) => {\r\n        this.defForm = data.data;\r\n        if (!data.data.content) {\r\n          this.defForm.content = \"\";\r\n        }\r\n        if (data.data.parentId == 0) {\r\n          this.defForm.parentId = null;\r\n        }\r\n        if (data.data.single == \"Y\") {\r\n          this.defForm.single = true;\r\n        } else {\r\n          this.defForm.single = false;\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        this.$message.error(error);\r\n      });\r\n\r\n    tree()\r\n      .then((data) => {\r\n        this.treeData = data.data;\r\n        console.log(this.treeData);\r\n      })\r\n      .catch(() => {});\r\n  },\r\n  methods: {\r\n    submitForm() {\r\n      this.$refs[\"defForm\"].validate((valid) => {\r\n        if (valid) {\r\n          console.log(this.defForm);\r\n          this.loading = true;\r\n          if (this.defForm.single) {\r\n            this.defForm.single = \"Y\";\r\n          } else {\r\n            this.defForm.single = \"N\";\r\n          }\r\n          update(this.defForm)\r\n            .then((data) => {\r\n              this.loading = false;\r\n              this.$refs[\"defForm\"].resetFields();\r\n              this.$message.success(data.msg);\r\n              this.$router.push(\"/channel\");\r\n            })\r\n            .catch((error) => {\r\n              this.loading = false;\r\n              this.$message.error(error);\r\n            });\r\n        }\r\n      });\r\n    },\r\n    close() {\r\n      this.$emit(\"hideDialog\");\r\n    },\r\n    uploadImg(param) {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", param.file);\r\n      upload(formData)\r\n        .then((data) => {\r\n          this.defForm.channelImg = data.data;\r\n        })\r\n        .catch((error) => {\r\n          this.$message.error(error);\r\n        });\r\n    },\r\n    //上传之前的验证\r\n    beforeAvatarUpload(file) {\r\n      const isIMAGE =\r\n        file.type === \"image/jpeg\" ||\r\n        file.type === \"image/jpg\" ||\r\n        file.type === \"image/png\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n      if (!isIMAGE) {\r\n        this.$message.error(\"上传文件只能是图片格式!\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传文件大小不能超过 2MB!\");\r\n      }\r\n      return isIMAGE && isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-uploader {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  width: 80px;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 80px;\r\n  height: 80px;\r\n  line-height: 80px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 80px;\r\n  height: 80px;\r\n  display: block;\r\n}\r\n</style>"]}]}